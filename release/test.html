
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<TITLE>NPAPI testing</TITLE>
</HEAD>

<BODY>
	<div class="playersquare">

		<div id="flashwindow"></div>

		<script type="text/javascript">
			<!--
			function InitDevice() {
				var flash = document.getElementById("FlashNess");
				var port = "com4";
				var device = flash.InitDevice(port);
				alert(device);
			}
			function CloseDevice() {
				var flash = document.getElementById("FlashNess");
				var device = 100;
				flash.CloseDevice(device);
			}
			function Beep() {
				var flash = document.getElementById("FlashNess");
				var times = 1;
				flash.Beep(times);
			}
			function ReadCard() {
				var flash = document.getElementById("FlashNess");
				var result = flash.ReadCard();
				alert(result);
			}
			function ReadData() {
				var flash = document.getElementById("FlashNess");
				flash.WriteData("https://www.ant.sh?data=0100000110010100232");
				var data = flash.ReadData();
				alert(data);
			}
			function ReadName() {
				var flash = document.getElementById("FlashNess");
				flash.name = "https://www.ant.sh?name=suhao";
				var name = flash.name;
				alert(name);
			}
			function GetModulePath() {
				var flash = document.getElementById("FlashNess");
				var path = flash.GetModulePath();
				alert(path);
			}
			function CreateService() {
				var flash = document.getElementById("FlashNess");
				var path = flash.GetModulePath();
				path += "reg.bat";
				alert(path);
				flash.CreateService(path);
			}
			
			function isIE() { //ie?  
				if (!!window.ActiveXObject || "ActiveXObject" in window)  
					return true;
				else
					return false;
			}
			function FlashNessPlugin(id, opts){
                var opts = opts || {},self = this;
				this.objectConfine = document.getElementById(id);
				this.width = opts.width || "0";
                this.height = opts.height || "0";
				this.flash = this.pluginObject().replace(/\{\{width\}\}/,this.width).replace(/\{\{height\}\}/,this.height);
                this.objectConfine.innerHTML = this.flash;
            }
            FlashNessPlugin.prototype={
                pluginObject : function(){
					var head = '<object id="FlashNess" width="{{width}}" height="{{height}}" ';
					var sign = (isIE() ? 'CLASSID="CLSID:6DD1301A-DCB4-43E4-9447-B1C7EA0ABACB">' : 'type="application/npFlashNess">');
                    var tail = '<param NAME="clsid" value="{6DD1301A-DCB4-43E4-9447-B1C7EA0ABACB}"></object>';
                    return (head+sign+tail);
                }
            }
			new FlashNessPlugin("flashwindow");
			//-->
		</script>
	</div>
	
	<p name="test">
		<button onclick="ReadData()"> ReadData </button>
		<button onclick="ReadName()"> ReadName </button>
		<button onclick="GetModulePath()"> GetModulePath </button>
		<button onclick="CreateService()"> CreateService </button>
	</p>
	<p name="card">
		<button onclick="InitDevice()"> InitDevice </button>
		<button onclick="Beep()"> Beep </button>
		<button onclick="ReadCard()"> ReadCard </button>
		<button onclick="CloseDevice()">CloseDevice</button>
	</p>


</BODY>



